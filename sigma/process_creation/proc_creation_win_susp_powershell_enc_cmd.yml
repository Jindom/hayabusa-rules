
title: Suspicious Encoded PowerShell Command Line
author: Florian Roth, Markus Neis, Jonhnathan Ribeiro, Daniil Yugoslavskiy, Anton
  Kutepov, oscd.community
date: 2018/09/03
description: Detects suspicious powershell process starts with base64 encoded commands
  (e.g. Emotet)
detection:
  SELECTION_1:
    CommandLine: '* -e*'
  SELECTION_2:
    CommandLine: '* JAB*'
  SELECTION_3:
    CommandLine: '* -w*'
  SELECTION_4:
    CommandLine: '* hidden *'
  SELECTION_5:
    CommandLine: '* -e*'
  SELECTION_6:
    CommandLine:
    - '* BA^J*'
    - '* SUVYI*'
    - '* SQBFAFgA*'
    - '* aQBlAHgA*'
    - '* aWV4I*'
    - '* IAA*'
    - '* IAB*'
    - '* UwB*'
    - '* cwB*'
  SELECTION_7:
    CommandLine:
    - '*.exe -ENCOD *'
  SELECTION_8:
    CommandLine: '* -ExecutionPolicy*'
  SELECTION_9:
    CommandLine: '*remotesigned *'
  condition: (((SELECTION_1 and SELECTION_2 and SELECTION_3 and SELECTION_4) or (SELECTION_5
    and SELECTION_6) or SELECTION_7) and  not (SELECTION_8 and SELECTION_9))
id: ca2092a1-c273-4878-9b4b-0d60115bf5ea
level: high
logsource:
  category: process_creation
  product: windows
modified: 2021/03/02
references:
- https://app.any.run/tasks/6217d77d-3189-4db2-a957-8ab239f3e01e
status: experimental
tags:
- attack.execution
- attack.t1059.001
